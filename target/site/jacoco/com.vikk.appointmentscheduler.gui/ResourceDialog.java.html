<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>ResourceDialog.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Appointment Scheduling Optimizer</a> &gt; <a href="index.source.html" class="el_package">com.vikk.appointmentscheduler.gui</a> &gt; <span class="el_source">ResourceDialog.java</span></div><h1>ResourceDialog.java</h1><pre class="source lang-java linenums">package com.vikk.appointmentscheduler.gui;

import com.vikk.appointmentscheduler.model.Resource;
import com.vikk.appointmentscheduler.model.ResourceType;

import javafx.geometry.Insets;
import javafx.scene.Scene;
import javafx.scene.control.Alert;
import javafx.scene.control.Button;
import javafx.scene.control.ButtonType;
import javafx.scene.control.CheckBox;
import javafx.scene.control.ComboBox;
import javafx.scene.control.DatePicker;
import javafx.scene.control.Dialog;
import javafx.scene.control.Label;
import javafx.scene.control.Spinner;
import javafx.scene.control.TextArea;
import javafx.scene.control.TextField;
import javafx.scene.layout.ColumnConstraints;
import javafx.scene.layout.GridPane;
import javafx.scene.layout.HBox;
import javafx.scene.layout.VBox;
import javafx.stage.Modality;
import javafx.stage.Stage;

import java.time.Duration;
import java.time.LocalDateTime;
import java.time.LocalTime;
import java.time.format.DateTimeFormatter;
import java.util.HashSet;
import java.util.Set;

/**
 * Dialog for creating and editing resources.
 */
public class ResourceDialog {
<span class="nc" id="L37">    private static final DateTimeFormatter FORMATTER = DateTimeFormatter.ofPattern(&quot;yyyy-MM-dd HH:mm&quot;);</span>
    
    private Stage dialog;
    private Resource resource;
    private boolean isEdit;
    
    // Form controls
    private TextField idField;
    private TextField nameField;
    private ComboBox&lt;ResourceType&gt; typeComboBox;
    private Spinner&lt;Double&gt; costSpinner;
    private Spinner&lt;Integer&gt; capacitySpinner;
    private CheckBox activeCheckBox;
    private DatePicker availableFromDatePicker;
    private Spinner&lt;Integer&gt; availableFromHourSpinner;
    private Spinner&lt;Integer&gt; availableFromMinuteSpinner;
    private DatePicker availableToDatePicker;
    private Spinner&lt;Integer&gt; availableToHourSpinner;
    private Spinner&lt;Integer&gt; availableToMinuteSpinner;
    private Spinner&lt;Integer&gt; setupTimeSpinner;
    private Spinner&lt;Integer&gt; cleanupTimeSpinner;
    private TextArea capabilitiesArea;
    
<span class="nc" id="L60">    public ResourceDialog(Stage parent, Resource resource) {</span>
<span class="nc" id="L61">        this.resource = resource;</span>
<span class="nc bnc" id="L62" title="All 2 branches missed.">        this.isEdit = resource != null;</span>
<span class="nc" id="L63">        createDialog(parent);</span>
<span class="nc" id="L64">    }</span>
    
    private void createDialog(Stage parent) {
<span class="nc" id="L67">        dialog = new Stage();</span>
<span class="nc" id="L68">        dialog.initModality(Modality.APPLICATION_MODAL);</span>
<span class="nc" id="L69">        dialog.initOwner(parent);</span>
<span class="nc bnc" id="L70" title="All 2 branches missed.">        dialog.setTitle(isEdit ? &quot;Edit Resource&quot; : &quot;Add New Resource&quot;);</span>
<span class="nc" id="L71">        dialog.setResizable(true);</span>
        
<span class="nc" id="L73">        VBox mainLayout = new VBox(15);</span>
<span class="nc" id="L74">        mainLayout.setPadding(new Insets(20));</span>
        
        // Create form
<span class="nc" id="L77">        GridPane form = createForm();</span>
<span class="nc" id="L78">        mainLayout.getChildren().add(form);</span>
        
        // Create buttons
<span class="nc" id="L81">        HBox buttonBox = createButtons();</span>
<span class="nc" id="L82">        mainLayout.getChildren().add(buttonBox);</span>
        
<span class="nc" id="L84">        Scene scene = new Scene(mainLayout, 700, 800);</span>
<span class="nc" id="L85">        dialog.setScene(scene);</span>
        
        // Populate form if editing
<span class="nc bnc" id="L88" title="All 2 branches missed.">        if (isEdit) {</span>
<span class="nc" id="L89">            populateForm();</span>
        }
<span class="nc" id="L91">    }</span>
    
    private GridPane createForm() {
<span class="nc" id="L94">        GridPane form = new GridPane();</span>
<span class="nc" id="L95">        form.setHgap(15);</span>
<span class="nc" id="L96">        form.setVgap(12);</span>
<span class="nc" id="L97">        form.setPadding(new Insets(10));</span>
        
        // Set column constraints for better layout
<span class="nc" id="L100">        ColumnConstraints labelCol = new ColumnConstraints();</span>
<span class="nc" id="L101">        labelCol.setMinWidth(150);</span>
<span class="nc" id="L102">        labelCol.setPrefWidth(150);</span>
        
<span class="nc" id="L104">        ColumnConstraints fieldCol = new ColumnConstraints();</span>
<span class="nc" id="L105">        fieldCol.setMinWidth(200);</span>
<span class="nc" id="L106">        fieldCol.setPrefWidth(300);</span>
<span class="nc" id="L107">        fieldCol.setHgrow(javafx.scene.layout.Priority.ALWAYS);</span>
        
<span class="nc" id="L109">        form.getColumnConstraints().addAll(labelCol, fieldCol);</span>
        
<span class="nc" id="L111">        int row = 0;</span>
        
        // ID
<span class="nc" id="L114">        form.add(new Label(&quot;ID:&quot;), 0, row);</span>
<span class="nc" id="L115">        idField = new TextField();</span>
<span class="nc" id="L116">        idField.setPromptText(&quot;e.g., ROOM001&quot;);</span>
<span class="nc" id="L117">        form.add(idField, 1, row++);</span>
        
        // Name
<span class="nc" id="L120">        form.add(new Label(&quot;Name:&quot;), 0, row);</span>
<span class="nc" id="L121">        nameField = new TextField();</span>
<span class="nc" id="L122">        nameField.setPromptText(&quot;Resource name&quot;);</span>
<span class="nc" id="L123">        form.add(nameField, 1, row++);</span>
        
        // Type
<span class="nc" id="L126">        form.add(new Label(&quot;Type:&quot;), 0, row);</span>
<span class="nc" id="L127">        typeComboBox = new ComboBox&lt;&gt;();</span>
<span class="nc" id="L128">        typeComboBox.getItems().addAll(ResourceType.values());</span>
<span class="nc" id="L129">        typeComboBox.setValue(ResourceType.ROOM);</span>
<span class="nc" id="L130">        form.add(typeComboBox, 1, row++);</span>
        
        // Cost per hour
<span class="nc" id="L133">        form.add(new Label(&quot;Cost per Hour ($):&quot;), 0, row);</span>
<span class="nc" id="L134">        costSpinner = new Spinner&lt;&gt;(0.0, 1000.0, 50.0, 5.0);</span>
<span class="nc" id="L135">        costSpinner.setEditable(true);</span>
<span class="nc" id="L136">        form.add(costSpinner, 1, row++);</span>
        
        // Capacity
<span class="nc" id="L139">        form.add(new Label(&quot;Capacity:&quot;), 0, row);</span>
<span class="nc" id="L140">        capacitySpinner = new Spinner&lt;&gt;(1, 100, 1);</span>
<span class="nc" id="L141">        capacitySpinner.setEditable(true);</span>
<span class="nc" id="L142">        form.add(capacitySpinner, 1, row++);</span>
        
        // Active
<span class="nc" id="L145">        form.add(new Label(&quot;Active:&quot;), 0, row);</span>
<span class="nc" id="L146">        activeCheckBox = new CheckBox(&quot;Resource is available for scheduling&quot;);</span>
<span class="nc" id="L147">        activeCheckBox.setSelected(true);</span>
<span class="nc" id="L148">        form.add(activeCheckBox, 1, row++);</span>
        
        // Available From
<span class="nc" id="L151">        form.add(new Label(&quot;Available From:&quot;), 0, row);</span>
<span class="nc" id="L152">        HBox availableFromBox = new HBox(5);</span>
<span class="nc" id="L153">        availableFromDatePicker = new DatePicker();</span>
<span class="nc" id="L154">        availableFromDatePicker.setValue(LocalDateTime.now().toLocalDate());</span>
<span class="nc" id="L155">        availableFromHourSpinner = new Spinner&lt;&gt;(0, 23, 8);</span>
<span class="nc" id="L156">        availableFromMinuteSpinner = new Spinner&lt;&gt;(0, 59, 0);</span>
<span class="nc" id="L157">        availableFromBox.getChildren().addAll(</span>
            availableFromDatePicker,
            new Label(&quot;Time:&quot;), availableFromHourSpinner,
            new Label(&quot;:&quot;), availableFromMinuteSpinner
        );
<span class="nc" id="L162">        form.add(availableFromBox, 1, row++);</span>
        
        // Available To
<span class="nc" id="L165">        form.add(new Label(&quot;Available To:&quot;), 0, row);</span>
<span class="nc" id="L166">        HBox availableToBox = new HBox(5);</span>
<span class="nc" id="L167">        availableToDatePicker = new DatePicker();</span>
<span class="nc" id="L168">        availableToDatePicker.setValue(LocalDateTime.now().plusDays(1).toLocalDate());</span>
<span class="nc" id="L169">        availableToHourSpinner = new Spinner&lt;&gt;(0, 23, 17);</span>
<span class="nc" id="L170">        availableToMinuteSpinner = new Spinner&lt;&gt;(0, 59, 0);</span>
<span class="nc" id="L171">        availableToBox.getChildren().addAll(</span>
            availableToDatePicker,
            new Label(&quot;Time:&quot;), availableToHourSpinner,
            new Label(&quot;:&quot;), availableToMinuteSpinner
        );
<span class="nc" id="L176">        form.add(availableToBox, 1, row++);</span>
        
        // Setup Time
<span class="nc" id="L179">        form.add(new Label(&quot;Setup Time (min):&quot;), 0, row);</span>
<span class="nc" id="L180">        setupTimeSpinner = new Spinner&lt;&gt;(0, 120, 0);</span>
<span class="nc" id="L181">        setupTimeSpinner.setEditable(true);</span>
<span class="nc" id="L182">        form.add(setupTimeSpinner, 1, row++);</span>
        
        // Cleanup Time
<span class="nc" id="L185">        form.add(new Label(&quot;Cleanup Time (min):&quot;), 0, row);</span>
<span class="nc" id="L186">        cleanupTimeSpinner = new Spinner&lt;&gt;(0, 120, 0);</span>
<span class="nc" id="L187">        cleanupTimeSpinner.setEditable(true);</span>
<span class="nc" id="L188">        form.add(cleanupTimeSpinner, 1, row++);</span>
        
        // Capabilities
<span class="nc" id="L191">        form.add(new Label(&quot;Capabilities:&quot;), 0, row);</span>
<span class="nc" id="L192">        capabilitiesArea = new TextArea();</span>
<span class="nc" id="L193">        capabilitiesArea.setPromptText(&quot;Enter capabilities separated by commas (e.g., CONSULTATION, EMERGENCY, SURGERY)&quot;);</span>
<span class="nc" id="L194">        capabilitiesArea.setPrefRowCount(3);</span>
<span class="nc" id="L195">        form.add(capabilitiesArea, 1, row++);</span>
        
<span class="nc" id="L197">        return form;</span>
    }
    
    private HBox createButtons() {
<span class="nc" id="L201">        HBox buttonBox = new HBox(10);</span>
<span class="nc" id="L202">        buttonBox.setPadding(new Insets(20, 0, 0, 0));</span>
        
<span class="nc bnc" id="L204" title="All 2 branches missed.">        Button saveButton = new Button(isEdit ? &quot;Update&quot; : &quot;Save&quot;);</span>
<span class="nc" id="L205">        saveButton.setDefaultButton(true);</span>
<span class="nc" id="L206">        saveButton.setOnAction(e -&gt; saveResource());</span>
        
<span class="nc" id="L208">        Button cancelButton = new Button(&quot;Cancel&quot;);</span>
<span class="nc" id="L209">        cancelButton.setOnAction(e -&gt; dialog.close());</span>
        
<span class="nc" id="L211">        buttonBox.getChildren().addAll(saveButton, cancelButton);</span>
        
<span class="nc" id="L213">        return buttonBox;</span>
    }
    
    private void populateForm() {
<span class="nc bnc" id="L217" title="All 2 branches missed.">        if (resource == null) return;</span>
        
<span class="nc" id="L219">        idField.setText(resource.getId());</span>
<span class="nc" id="L220">        nameField.setText(resource.getName());</span>
<span class="nc" id="L221">        typeComboBox.setValue(resource.getType());</span>
<span class="nc" id="L222">        costSpinner.getValueFactory().setValue(resource.getCostPerHour());</span>
<span class="nc" id="L223">        capacitySpinner.getValueFactory().setValue(resource.getCapacity());</span>
<span class="nc" id="L224">        activeCheckBox.setSelected(resource.isActive());</span>
        
<span class="nc bnc" id="L226" title="All 2 branches missed.">        if (resource.getAvailableFrom() != null) {</span>
<span class="nc" id="L227">            availableFromDatePicker.setValue(resource.getAvailableFrom().toLocalDate());</span>
<span class="nc" id="L228">            availableFromHourSpinner.getValueFactory().setValue(resource.getAvailableFrom().getHour());</span>
<span class="nc" id="L229">            availableFromMinuteSpinner.getValueFactory().setValue(resource.getAvailableFrom().getMinute());</span>
        }
        
<span class="nc bnc" id="L232" title="All 2 branches missed.">        if (resource.getAvailableTo() != null) {</span>
<span class="nc" id="L233">            availableToDatePicker.setValue(resource.getAvailableTo().toLocalDate());</span>
<span class="nc" id="L234">            availableToHourSpinner.getValueFactory().setValue(resource.getAvailableTo().getHour());</span>
<span class="nc" id="L235">            availableToMinuteSpinner.getValueFactory().setValue(resource.getAvailableTo().getMinute());</span>
        }
        
<span class="nc" id="L238">        setupTimeSpinner.getValueFactory().setValue((int) resource.getSetupTime().toMinutes());</span>
<span class="nc" id="L239">        cleanupTimeSpinner.getValueFactory().setValue((int) resource.getCleanupTime().toMinutes());</span>
        
        // Capabilities
<span class="nc" id="L242">        capabilitiesArea.setText(String.join(&quot;, &quot;, resource.getCapabilities()));</span>
<span class="nc" id="L243">    }</span>
    
    private void saveResource() {
        try {
            // Validate required fields
<span class="nc bnc" id="L248" title="All 2 branches missed.">            if (idField.getText().trim().isEmpty()) {</span>
<span class="nc" id="L249">                showAlert(&quot;Validation Error&quot;, &quot;ID is required&quot;);</span>
<span class="nc" id="L250">                return;</span>
            }
<span class="nc bnc" id="L252" title="All 2 branches missed.">            if (nameField.getText().trim().isEmpty()) {</span>
<span class="nc" id="L253">                showAlert(&quot;Validation Error&quot;, &quot;Name is required&quot;);</span>
<span class="nc" id="L254">                return;</span>
            }
<span class="nc bnc" id="L256" title="All 2 branches missed.">            if (availableFromDatePicker.getValue() == null) {</span>
<span class="nc" id="L257">                showAlert(&quot;Validation Error&quot;, &quot;Available from date is required&quot;);</span>
<span class="nc" id="L258">                return;</span>
            }
<span class="nc bnc" id="L260" title="All 2 branches missed.">            if (availableToDatePicker.getValue() == null) {</span>
<span class="nc" id="L261">                showAlert(&quot;Validation Error&quot;, &quot;Available to date is required&quot;);</span>
<span class="nc" id="L262">                return;</span>
            }
            
            // Create or update resource
<span class="nc bnc" id="L266" title="All 2 branches missed.">            if (resource == null) {</span>
<span class="nc" id="L267">                resource = new Resource();</span>
            }
            
<span class="nc" id="L270">            resource.setId(idField.getText().trim());</span>
<span class="nc" id="L271">            resource.setName(nameField.getText().trim());</span>
<span class="nc" id="L272">            resource.setType(typeComboBox.getValue());</span>
<span class="nc" id="L273">            resource.setCostPerHour(costSpinner.getValue());</span>
<span class="nc" id="L274">            resource.setCapacity(capacitySpinner.getValue());</span>
<span class="nc" id="L275">            resource.setActive(activeCheckBox.isSelected());</span>
            
            // Set available from time
<span class="nc" id="L278">            LocalDateTime availableFrom = LocalDateTime.of(</span>
<span class="nc" id="L279">                availableFromDatePicker.getValue(),</span>
<span class="nc" id="L280">                LocalTime.of(availableFromHourSpinner.getValue().intValue(), availableFromMinuteSpinner.getValue().intValue())</span>
            );
<span class="nc" id="L282">            resource.setAvailableFrom(availableFrom);</span>
            
            // Set available to time
<span class="nc" id="L285">            LocalDateTime availableTo = LocalDateTime.of(</span>
<span class="nc" id="L286">                availableToDatePicker.getValue(),</span>
<span class="nc" id="L287">                LocalTime.of(availableToHourSpinner.getValue().intValue(), availableToMinuteSpinner.getValue().intValue())</span>
            );
<span class="nc" id="L289">            resource.setAvailableTo(availableTo);</span>
            
<span class="nc" id="L291">            resource.setSetupTime(Duration.ofMinutes(setupTimeSpinner.getValue()));</span>
<span class="nc" id="L292">            resource.setCleanupTime(Duration.ofMinutes(cleanupTimeSpinner.getValue()));</span>
            
            // Parse capabilities
<span class="nc" id="L295">            String capabilitiesText = capabilitiesArea.getText().trim();</span>
<span class="nc" id="L296">            Set&lt;String&gt; capabilities = new HashSet&lt;&gt;();</span>
<span class="nc bnc" id="L297" title="All 2 branches missed.">            if (!capabilitiesText.isEmpty()) {</span>
<span class="nc" id="L298">                String[] parts = capabilitiesText.split(&quot;,&quot;);</span>
<span class="nc bnc" id="L299" title="All 2 branches missed.">                for (String part : parts) {</span>
<span class="nc" id="L300">                    capabilities.add(part.trim().toUpperCase());</span>
                }
            }
<span class="nc" id="L303">            resource.setCapabilities(capabilities);</span>
            
<span class="nc" id="L305">            dialog.close();</span>
            
<span class="nc" id="L307">        } catch (Exception e) {</span>
<span class="nc" id="L308">            showAlert(&quot;Error&quot;, &quot;Failed to save resource: &quot; + e.getMessage());</span>
<span class="nc" id="L309">        }</span>
<span class="nc" id="L310">    }</span>
    
    private void showAlert(String title, String message) {
<span class="nc" id="L313">        Alert alert = new Alert(Alert.AlertType.ERROR);</span>
<span class="nc" id="L314">        alert.setTitle(title);</span>
<span class="nc" id="L315">        alert.setHeaderText(null);</span>
<span class="nc" id="L316">        alert.setContentText(message);</span>
<span class="nc" id="L317">        alert.showAndWait();</span>
<span class="nc" id="L318">    }</span>
    
    public Resource showAndWait() {
<span class="nc" id="L321">        dialog.showAndWait();</span>
<span class="nc" id="L322">        return resource;</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.10.202304240956</span></div></body></html>