<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>SchedulingGUI.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Appointment Scheduling Optimizer</a> &gt; <a href="index.source.html" class="el_package">com.vikk.appointmentscheduler.gui</a> &gt; <span class="el_source">SchedulingGUI.java</span></div><h1>SchedulingGUI.java</h1><pre class="source lang-java linenums">package com.vikk.appointmentscheduler.gui;

import com.vikk.appointmentscheduler.algorithm.ConstraintSatisfactionAlgorithm;
import com.vikk.appointmentscheduler.algorithm.GeneticAlgorithm;
import com.vikk.appointmentscheduler.algorithm.SimulatedAnnealingAlgorithm;
import com.vikk.appointmentscheduler.algorithm.SchedulingAlgorithm;
import com.vikk.appointmentscheduler.database.AppointmentDAO;
import com.vikk.appointmentscheduler.database.DatabaseManager;
import com.vikk.appointmentscheduler.database.ResourceDAO;
import com.vikk.appointmentscheduler.model.Appointment;
import com.vikk.appointmentscheduler.model.AppointmentStatus;
import com.vikk.appointmentscheduler.model.AppointmentType;
import com.vikk.appointmentscheduler.model.Resource;
import com.vikk.appointmentscheduler.model.ResourceType;
import com.vikk.appointmentscheduler.model.Schedule;
import com.vikk.appointmentscheduler.model.ScheduleMetrics;
import com.vikk.appointmentscheduler.service.AppointmentSchedulingService;
import com.vikk.appointmentscheduler.util.MathUtils;

import javafx.application.Application;
import javafx.application.Platform;
import javafx.collections.FXCollections;
import javafx.collections.ObservableList;
import javafx.geometry.Insets;
import javafx.geometry.Pos;
import javafx.scene.Scene;
import javafx.scene.control.Alert;
import javafx.scene.control.Button;
import javafx.scene.control.ButtonType;
import javafx.scene.control.CheckBox;
import javafx.scene.control.ComboBox;
import javafx.scene.control.ContextMenu;
import javafx.scene.control.Label;
import javafx.scene.control.MenuItem;
import javafx.scene.control.ProgressBar;
import javafx.scene.control.ScrollPane;
import javafx.scene.control.Tab;
import javafx.scene.control.TabPane;
import javafx.scene.control.TableColumn;
import javafx.scene.control.TableView;
import javafx.scene.control.TextArea;
import javafx.scene.control.TextField;
import javafx.scene.control.cell.PropertyValueFactory;
import javafx.scene.layout.BorderPane;
import javafx.scene.layout.ColumnConstraints;
import javafx.scene.layout.GridPane;
import javafx.scene.layout.HBox;
import javafx.scene.layout.Priority;
import javafx.scene.layout.RowConstraints;
import javafx.scene.layout.VBox;
import javafx.scene.paint.Color;
import javafx.scene.text.Font;
import javafx.scene.text.FontWeight;
import javafx.stage.Stage;

import java.time.Duration;
import java.time.LocalDateTime;
import java.time.format.DateTimeFormatter;
import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;
import java.util.Map;
import java.util.Set;
import java.util.concurrent.CompletableFuture;
import java.util.stream.Collectors;

/**
 * JavaFX GUI for the Appointment Scheduling Optimizer.
 * Provides a user-friendly interface for managing appointments, resources,
 * and running optimization algorithms.
 */
<span class="nc" id="L72">public class SchedulingGUI extends Application {</span>

<span class="nc" id="L74">    private static final DateTimeFormatter TIME_FORMATTER = DateTimeFormatter.ofPattern(&quot;yyyy-MM-dd HH:mm&quot;);</span>
    
    // Data
<span class="nc" id="L77">    private ObservableList&lt;Appointment&gt; appointments = FXCollections.observableArrayList();</span>
<span class="nc" id="L78">    private ObservableList&lt;Resource&gt; resources = FXCollections.observableArrayList();</span>
    private AppointmentSchedulingService schedulingService;
<span class="nc" id="L80">    private Map&lt;String, Schedule&gt; optimizationResults = new HashMap&lt;&gt;();</span>
    
    // Database
    private AppointmentDAO appointmentDAO;
    private ResourceDAO resourceDAO;
    
    // UI Components
    private TableView&lt;Appointment&gt; appointmentTable;
    private TableView&lt;Resource&gt; resourceTable;
    private TableView&lt;ScheduleResult&gt; resultTable;
    private TextArea logArea;
    private ProgressBar progressBar;
    private Label statusLabel;
    private TextArea scheduleArea;
    
    // Algorithm selection
    private CheckBox cspCheckBox;
    private CheckBox gaCheckBox;
    private CheckBox saCheckBox;

    @Override
    public void start(Stage primaryStage) {
<span class="nc" id="L102">        primaryStage.setTitle(&quot;Appointment Scheduling Optimizer&quot;);</span>
<span class="nc" id="L103">        primaryStage.setMinWidth(1200);</span>
<span class="nc" id="L104">        primaryStage.setMinHeight(800);</span>

        // Create main layout
<span class="nc" id="L107">        BorderPane root = new BorderPane();</span>
<span class="nc" id="L108">        root.setPadding(new Insets(10));</span>

        // Top: Title and controls
<span class="nc" id="L111">        VBox topPanel = createTopPanel();</span>
<span class="nc" id="L112">        root.setTop(topPanel);</span>

        // Center: Main content with tabs
<span class="nc" id="L115">        TabPane tabPane = createTabPane();</span>
<span class="nc" id="L116">        root.setCenter(tabPane);</span>

        // Bottom: Status and progress
<span class="nc" id="L119">        HBox bottomPanel = createBottomPanel();</span>
<span class="nc" id="L120">        root.setBottom(bottomPanel);</span>

        // Initialize database after UI is created
<span class="nc" id="L123">        initializeDatabase();</span>
        
        // Load data from database
<span class="nc" id="L126">        loadDataFromDatabase();</span>
        
<span class="nc" id="L128">        schedulingService = new AppointmentSchedulingService(</span>
<span class="nc" id="L129">            appointments.stream().collect(Collectors.toList()),</span>
<span class="nc" id="L130">            resources.stream().collect(Collectors.toList())</span>
        );

<span class="nc" id="L133">        Scene scene = new Scene(root, 1200, 800);</span>
<span class="nc" id="L134">        primaryStage.setScene(scene);</span>
<span class="nc" id="L135">        primaryStage.show();</span>
<span class="nc" id="L136">    }</span>

    private VBox createTopPanel() {
<span class="nc" id="L139">        VBox topPanel = new VBox(10);</span>
<span class="nc" id="L140">        topPanel.setPadding(new Insets(10));</span>

        // Title
<span class="nc" id="L143">        Label titleLabel = new Label(&quot;Appointment Scheduling Optimizer&quot;);</span>
<span class="nc" id="L144">        titleLabel.setFont(Font.font(&quot;Arial&quot;, FontWeight.BOLD, 24));</span>
<span class="nc" id="L145">        titleLabel.setTextFill(Color.DARKBLUE);</span>

        // Algorithm selection
<span class="nc" id="L148">        HBox algorithmPanel = new HBox(20);</span>
<span class="nc" id="L149">        algorithmPanel.setAlignment(Pos.CENTER_LEFT);</span>
        
<span class="nc" id="L151">        Label algorithmLabel = new Label(&quot;Select Algorithms:&quot;);</span>
<span class="nc" id="L152">        algorithmLabel.setFont(Font.font(&quot;Arial&quot;, FontWeight.BOLD, 14));</span>
        
<span class="nc" id="L154">        cspCheckBox = new CheckBox(&quot;Constraint Satisfaction (CSP)&quot;);</span>
<span class="nc" id="L155">        gaCheckBox = new CheckBox(&quot;Genetic Algorithm (GA)&quot;);</span>
<span class="nc" id="L156">        saCheckBox = new CheckBox(&quot;Simulated Annealing (SA)&quot;);</span>
        
        // Select all by default
<span class="nc" id="L159">        cspCheckBox.setSelected(true);</span>
<span class="nc" id="L160">        gaCheckBox.setSelected(true);</span>
<span class="nc" id="L161">        saCheckBox.setSelected(true);</span>
        
<span class="nc" id="L163">        algorithmPanel.getChildren().addAll(algorithmLabel, cspCheckBox, gaCheckBox, saCheckBox);</span>

        // Control buttons
<span class="nc" id="L166">        HBox buttonPanel = new HBox(10);</span>
<span class="nc" id="L167">        buttonPanel.setAlignment(Pos.CENTER_LEFT);</span>
        
<span class="nc" id="L169">        Button runOptimizationButton = new Button(&quot;Run Optimization&quot;);</span>
<span class="nc" id="L170">        runOptimizationButton.setStyle(&quot;-fx-background-color: #4CAF50; -fx-text-fill: white; -fx-font-weight: bold;&quot;);</span>
<span class="nc" id="L171">        runOptimizationButton.setOnAction(e -&gt; runOptimization());</span>
        
<span class="nc" id="L173">        Button addAppointmentButton = new Button(&quot;Add Appointment&quot;);</span>
<span class="nc" id="L174">        addAppointmentButton.setStyle(&quot;-fx-background-color: #2196F3; -fx-text-fill: white;&quot;);</span>
<span class="nc" id="L175">        addAppointmentButton.setOnAction(e -&gt; showAddAppointmentDialog());</span>
        
<span class="nc" id="L177">        Button addResourceButton = new Button(&quot;Add Resource&quot;);</span>
<span class="nc" id="L178">        addResourceButton.setStyle(&quot;-fx-background-color: #FF9800; -fx-text-fill: white;&quot;);</span>
<span class="nc" id="L179">        addResourceButton.setOnAction(e -&gt; showAddResourceDialog());</span>
        
<span class="nc" id="L181">        Button clearDataButton = new Button(&quot;Clear All Data&quot;);</span>
<span class="nc" id="L182">        clearDataButton.setStyle(&quot;-fx-background-color: #F44336; -fx-text-fill: white;&quot;);</span>
<span class="nc" id="L183">        clearDataButton.setOnAction(e -&gt; clearAllData());</span>
        
<span class="nc" id="L185">        buttonPanel.getChildren().addAll(runOptimizationButton, addAppointmentButton, addResourceButton, clearDataButton);</span>

<span class="nc" id="L187">        topPanel.getChildren().addAll(titleLabel, algorithmPanel, buttonPanel);</span>
<span class="nc" id="L188">        return topPanel;</span>
    }

    private TabPane createTabPane() {
<span class="nc" id="L192">        TabPane tabPane = new TabPane();</span>

        // Appointments tab
<span class="nc" id="L195">        Tab appointmentsTab = new Tab(&quot;Appointments&quot;);</span>
<span class="nc" id="L196">        appointmentsTab.setContent(createAppointmentsTab());</span>
<span class="nc" id="L197">        appointmentsTab.setClosable(false);</span>

        // Resources tab
<span class="nc" id="L200">        Tab resourcesTab = new Tab(&quot;Resources&quot;);</span>
<span class="nc" id="L201">        resourcesTab.setContent(createResourcesTab());</span>
<span class="nc" id="L202">        resourcesTab.setClosable(false);</span>

        // Results tab
<span class="nc" id="L205">        Tab resultsTab = new Tab(&quot;Optimization Results&quot;);</span>
<span class="nc" id="L206">        resultsTab.setContent(createResultsTab());</span>
<span class="nc" id="L207">        resultsTab.setClosable(false);</span>

        // Schedule tab
<span class="nc" id="L210">        Tab scheduleTab = new Tab(&quot;Best Schedule&quot;);</span>
<span class="nc" id="L211">        scheduleTab.setContent(createScheduleTab());</span>
<span class="nc" id="L212">        scheduleTab.setClosable(false);</span>

<span class="nc" id="L214">        tabPane.getTabs().addAll(appointmentsTab, resourcesTab, resultsTab, scheduleTab);</span>
<span class="nc" id="L215">        return tabPane;</span>
    }

    private VBox createAppointmentsTab() {
<span class="nc" id="L219">        VBox vbox = new VBox(10);</span>
<span class="nc" id="L220">        vbox.setPadding(new Insets(10));</span>

        // Table
<span class="nc" id="L223">        appointmentTable = new TableView&lt;&gt;();</span>
<span class="nc" id="L224">        appointmentTable.setItems(appointments);</span>

        // Columns
<span class="nc" id="L227">        TableColumn&lt;Appointment, String&gt; idCol = new TableColumn&lt;&gt;(&quot;ID&quot;);</span>
<span class="nc" id="L228">        idCol.setCellValueFactory(new PropertyValueFactory&lt;&gt;(&quot;id&quot;));</span>

<span class="nc" id="L230">        TableColumn&lt;Appointment, String&gt; descriptionCol = new TableColumn&lt;&gt;(&quot;Description&quot;);</span>
<span class="nc" id="L231">        descriptionCol.setCellValueFactory(new PropertyValueFactory&lt;&gt;(&quot;description&quot;));</span>

<span class="nc" id="L233">        TableColumn&lt;Appointment, AppointmentType&gt; typeCol = new TableColumn&lt;&gt;(&quot;Type&quot;);</span>
<span class="nc" id="L234">        typeCol.setCellValueFactory(new PropertyValueFactory&lt;&gt;(&quot;type&quot;));</span>

<span class="nc" id="L236">        TableColumn&lt;Appointment, com.vikk.appointmentscheduler.model.Priority&gt; priorityCol = new TableColumn&lt;&gt;(&quot;Priority&quot;);</span>
<span class="nc" id="L237">        priorityCol.setCellValueFactory(new PropertyValueFactory&lt;&gt;(&quot;priority&quot;));</span>

<span class="nc" id="L239">        TableColumn&lt;Appointment, String&gt; startTimeCol = new TableColumn&lt;&gt;(&quot;Requested Start&quot;);</span>
<span class="nc" id="L240">        startTimeCol.setCellValueFactory(cellData -&gt; {</span>
<span class="nc" id="L241">            LocalDateTime startTime = cellData.getValue().getStartTime();</span>
<span class="nc" id="L242">            return new javafx.beans.property.SimpleStringProperty(</span>
<span class="nc bnc" id="L243" title="All 2 branches missed.">                startTime != null ? startTime.format(TIME_FORMATTER) : &quot;N/A&quot;</span>
            );
        });

<span class="nc" id="L247">        TableColumn&lt;Appointment, Long&gt; durationCol = new TableColumn&lt;&gt;(&quot;Duration (min)&quot;);</span>
<span class="nc" id="L248">        durationCol.setCellValueFactory(new PropertyValueFactory&lt;&gt;(&quot;durationMinutes&quot;));</span>

<span class="nc" id="L250">        TableColumn&lt;Appointment, com.vikk.appointmentscheduler.model.AppointmentStatus&gt; statusCol = new TableColumn&lt;&gt;(&quot;Status&quot;);</span>
<span class="nc" id="L251">        statusCol.setCellValueFactory(new PropertyValueFactory&lt;&gt;(&quot;status&quot;));</span>

<span class="nc" id="L253">        appointmentTable.getColumns().addAll(idCol, descriptionCol, typeCol, priorityCol, startTimeCol, durationCol, statusCol);</span>

        // Context menu
<span class="nc" id="L256">        ContextMenu contextMenu = new ContextMenu();</span>
<span class="nc" id="L257">        MenuItem editItem = new MenuItem(&quot;Edit&quot;);</span>
<span class="nc" id="L258">        editItem.setOnAction(e -&gt; editSelectedAppointment());</span>
<span class="nc" id="L259">        MenuItem deleteItem = new MenuItem(&quot;Delete&quot;);</span>
<span class="nc" id="L260">        deleteItem.setOnAction(e -&gt; deleteSelectedAppointment());</span>
<span class="nc" id="L261">        contextMenu.getItems().addAll(editItem, deleteItem);</span>
<span class="nc" id="L262">        appointmentTable.setContextMenu(contextMenu);</span>

<span class="nc" id="L264">        vbox.getChildren().add(appointmentTable);</span>
<span class="nc" id="L265">        return vbox;</span>
    }

    private VBox createResourcesTab() {
<span class="nc" id="L269">        VBox vbox = new VBox(10);</span>
<span class="nc" id="L270">        vbox.setPadding(new Insets(10));</span>

        // Table
<span class="nc" id="L273">        resourceTable = new TableView&lt;&gt;();</span>
<span class="nc" id="L274">        resourceTable.setItems(resources);</span>

        // Columns
<span class="nc" id="L277">        TableColumn&lt;Resource, String&gt; idCol = new TableColumn&lt;&gt;(&quot;ID&quot;);</span>
<span class="nc" id="L278">        idCol.setCellValueFactory(new PropertyValueFactory&lt;&gt;(&quot;id&quot;));</span>

<span class="nc" id="L280">        TableColumn&lt;Resource, String&gt; nameCol = new TableColumn&lt;&gt;(&quot;Name&quot;);</span>
<span class="nc" id="L281">        nameCol.setCellValueFactory(new PropertyValueFactory&lt;&gt;(&quot;name&quot;));</span>

<span class="nc" id="L283">        TableColumn&lt;Resource, ResourceType&gt; typeCol = new TableColumn&lt;&gt;(&quot;Type&quot;);</span>
<span class="nc" id="L284">        typeCol.setCellValueFactory(new PropertyValueFactory&lt;&gt;(&quot;type&quot;));</span>

<span class="nc" id="L286">        TableColumn&lt;Resource, String&gt; capabilitiesCol = new TableColumn&lt;&gt;(&quot;Capabilities&quot;);</span>
<span class="nc" id="L287">        capabilitiesCol.setCellValueFactory(cellData -&gt; {</span>
<span class="nc" id="L288">            Set&lt;String&gt; capabilities = cellData.getValue().getCapabilities();</span>
<span class="nc" id="L289">            return new javafx.beans.property.SimpleStringProperty(</span>
<span class="nc bnc" id="L290" title="All 2 branches missed.">                capabilities != null ? capabilities.toString() : &quot;All&quot;</span>
            );
        });

<span class="nc" id="L294">        TableColumn&lt;Resource, Double&gt; costCol = new TableColumn&lt;&gt;(&quot;Cost/Hour&quot;);</span>
<span class="nc" id="L295">        costCol.setCellValueFactory(cellData -&gt; {</span>
<span class="nc" id="L296">            double cost = cellData.getValue().getCostPerHour();</span>
<span class="nc" id="L297">            return new javafx.beans.property.SimpleDoubleProperty(cost).asObject();</span>
        });

<span class="nc" id="L300">        TableColumn&lt;Resource, String&gt; availabilityCol = new TableColumn&lt;&gt;(&quot;Availability&quot;);</span>
<span class="nc" id="L301">        availabilityCol.setCellValueFactory(cellData -&gt; {</span>
<span class="nc" id="L302">            Set&lt;LocalDateTime&gt; slots = cellData.getValue().getAvailableSlots();</span>
<span class="nc" id="L303">            return new javafx.beans.property.SimpleStringProperty(</span>
<span class="nc bnc" id="L304" title="All 2 branches missed.">                slots != null ? slots.size() + &quot; slots&quot; : &quot;0 slots&quot;</span>
            );
        });

<span class="nc" id="L308">        resourceTable.getColumns().addAll(idCol, nameCol, typeCol, capabilitiesCol, costCol, availabilityCol);</span>

        // Context menu
<span class="nc" id="L311">        ContextMenu contextMenu = new ContextMenu();</span>
<span class="nc" id="L312">        MenuItem editItem = new MenuItem(&quot;Edit&quot;);</span>
<span class="nc" id="L313">        editItem.setOnAction(e -&gt; editSelectedResource());</span>
<span class="nc" id="L314">        MenuItem deleteItem = new MenuItem(&quot;Delete&quot;);</span>
<span class="nc" id="L315">        deleteItem.setOnAction(e -&gt; deleteSelectedResource());</span>
<span class="nc" id="L316">        contextMenu.getItems().addAll(editItem, deleteItem);</span>
<span class="nc" id="L317">        resourceTable.setContextMenu(contextMenu);</span>

<span class="nc" id="L319">        vbox.getChildren().add(resourceTable);</span>
<span class="nc" id="L320">        return vbox;</span>
    }

    private VBox createResultsTab() {
<span class="nc" id="L324">        VBox vbox = new VBox(10);</span>
<span class="nc" id="L325">        vbox.setPadding(new Insets(10));</span>

        // Results table
<span class="nc" id="L328">        resultTable = new TableView&lt;&gt;();</span>
<span class="nc" id="L329">        resultTable.setItems(FXCollections.observableArrayList());</span>

        // Columns
<span class="nc" id="L332">        TableColumn&lt;ScheduleResult, String&gt; algorithmCol = new TableColumn&lt;&gt;(&quot;Algorithm&quot;);</span>
<span class="nc" id="L333">        algorithmCol.setCellValueFactory(new PropertyValueFactory&lt;&gt;(&quot;algorithmName&quot;));</span>

<span class="nc" id="L335">        TableColumn&lt;ScheduleResult, Long&gt; timeCol = new TableColumn&lt;&gt;(&quot;Time (ms)&quot;);</span>
<span class="nc" id="L336">        timeCol.setCellValueFactory(new PropertyValueFactory&lt;&gt;(&quot;executionTime&quot;));</span>

<span class="nc" id="L338">        TableColumn&lt;ScheduleResult, Integer&gt; iterationsCol = new TableColumn&lt;&gt;(&quot;Iterations&quot;);</span>
<span class="nc" id="L339">        iterationsCol.setCellValueFactory(new PropertyValueFactory&lt;&gt;(&quot;iterations&quot;));</span>

<span class="nc" id="L341">        TableColumn&lt;ScheduleResult, Double&gt; efficiencyCol = new TableColumn&lt;&gt;(&quot;Efficiency (%)&quot;);</span>
<span class="nc" id="L342">        efficiencyCol.setCellValueFactory(new PropertyValueFactory&lt;&gt;(&quot;efficiencyScore&quot;));</span>

<span class="nc" id="L344">        TableColumn&lt;ScheduleResult, Double&gt; costCol = new TableColumn&lt;&gt;(&quot;Cost ($)&quot;);</span>
<span class="nc" id="L345">        costCol.setCellValueFactory(new PropertyValueFactory&lt;&gt;(&quot;totalCost&quot;));</span>

<span class="nc" id="L347">        TableColumn&lt;ScheduleResult, Integer&gt; conflictsCol = new TableColumn&lt;&gt;(&quot;Conflicts&quot;);</span>
<span class="nc" id="L348">        conflictsCol.setCellValueFactory(new PropertyValueFactory&lt;&gt;(&quot;conflictCount&quot;));</span>

<span class="nc" id="L350">        resultTable.getColumns().addAll(algorithmCol, timeCol, iterationsCol, efficiencyCol, costCol, conflictsCol);</span>

<span class="nc" id="L352">        vbox.getChildren().add(resultTable);</span>
<span class="nc" id="L353">        return vbox;</span>
    }

    private VBox createScheduleTab() {
<span class="nc" id="L357">        VBox vbox = new VBox(10);</span>
<span class="nc" id="L358">        vbox.setPadding(new Insets(10));</span>

        // Schedule display
<span class="nc" id="L361">        scheduleArea = new TextArea();</span>
<span class="nc" id="L362">        scheduleArea.setEditable(false);</span>
<span class="nc" id="L363">        scheduleArea.setFont(Font.font(&quot;Courier New&quot;, 12));</span>
<span class="nc" id="L364">        scheduleArea.setPrefRowCount(20);</span>
<span class="nc" id="L365">        scheduleArea.setText(&quot;Run optimization to see the best schedule details.&quot;);</span>

        // Update schedule display when results change
<span class="nc" id="L368">        resultTable.getSelectionModel().selectedItemProperty().addListener((obs, oldVal, newVal) -&gt; {</span>
<span class="nc bnc" id="L369" title="All 2 branches missed.">            if (newVal != null) {</span>
<span class="nc" id="L370">                updateScheduleDisplay(scheduleArea, newVal);</span>
            }
<span class="nc" id="L372">        });</span>

<span class="nc" id="L374">        vbox.getChildren().add(scheduleArea);</span>
<span class="nc" id="L375">        return vbox;</span>
    }

    private HBox createBottomPanel() {
<span class="nc" id="L379">        HBox bottomPanel = new HBox(10);</span>
<span class="nc" id="L380">        bottomPanel.setPadding(new Insets(10));</span>
<span class="nc" id="L381">        bottomPanel.setAlignment(Pos.CENTER_LEFT);</span>

        // Progress bar
<span class="nc" id="L384">        progressBar = new ProgressBar();</span>
<span class="nc" id="L385">        progressBar.setVisible(false);</span>
<span class="nc" id="L386">        progressBar.setPrefWidth(200);</span>

        // Status label
<span class="nc" id="L389">        statusLabel = new Label(&quot;Ready&quot;);</span>
<span class="nc" id="L390">        statusLabel.setFont(Font.font(&quot;Arial&quot;, 12));</span>

        // Log area
<span class="nc" id="L393">        logArea = new TextArea();</span>
<span class="nc" id="L394">        logArea.setPrefRowCount(3);</span>
<span class="nc" id="L395">        logArea.setEditable(false);</span>
<span class="nc" id="L396">        logArea.setFont(Font.font(&quot;Courier New&quot;, 10));</span>

<span class="nc" id="L398">        VBox logBox = new VBox(5);</span>
<span class="nc" id="L399">        logBox.getChildren().addAll(new Label(&quot;Log:&quot;), logArea);</span>

<span class="nc" id="L401">        bottomPanel.getChildren().addAll(progressBar, statusLabel, logBox);</span>
<span class="nc" id="L402">        return bottomPanel;</span>
    }

    private void initializeDatabase() {
        try {
<span class="nc" id="L407">            appointmentDAO = new AppointmentDAO();</span>
<span class="nc" id="L408">            resourceDAO = new ResourceDAO();</span>
<span class="nc" id="L409">            logArea.appendText(&quot;Database initialized successfully\n&quot;);</span>
<span class="nc" id="L410">        } catch (Exception e) {</span>
<span class="nc" id="L411">            logArea.appendText(&quot;Error initializing database: &quot; + e.getMessage() + &quot;\n&quot;);</span>
<span class="nc" id="L412">            showAlert(&quot;Database Error&quot;, &quot;Failed to initialize database: &quot; + e.getMessage());</span>
<span class="nc" id="L413">        }</span>
<span class="nc" id="L414">    }</span>

    private void loadDataFromDatabase() {
        try {
            // Load appointments
<span class="nc" id="L419">            List&lt;Appointment&gt; appointmentList = appointmentDAO.findAll();</span>
<span class="nc" id="L420">            appointments.clear();</span>
<span class="nc" id="L421">            appointments.addAll(appointmentList);</span>
            
            // Load resources
<span class="nc" id="L424">            List&lt;Resource&gt; resourceList = resourceDAO.findAll();</span>
<span class="nc" id="L425">            resources.clear();</span>
<span class="nc" id="L426">            resources.addAll(resourceList);</span>
            
<span class="nc" id="L428">            logArea.appendText(&quot;Loaded &quot; + appointments.size() + &quot; appointments and &quot; + resources.size() + &quot; resources from database\n&quot;);</span>
            
            // If no data exists, create some sample data
<span class="nc bnc" id="L431" title="All 4 branches missed.">            if (appointments.isEmpty() &amp;&amp; resources.isEmpty()) {</span>
<span class="nc" id="L432">                createSampleData();</span>
            }
            
<span class="nc" id="L435">        } catch (Exception e) {</span>
<span class="nc" id="L436">            logArea.appendText(&quot;Error loading data from database: &quot; + e.getMessage() + &quot;\n&quot;);</span>
<span class="nc" id="L437">            showAlert(&quot;Database Error&quot;, &quot;Failed to load data: &quot; + e.getMessage());</span>
<span class="nc" id="L438">        }</span>
<span class="nc" id="L439">    }</span>

    private void createSampleData() {
        try {
            // Create sample appointments
<span class="nc" id="L444">            LocalDateTime now = LocalDateTime.now().truncatedTo(java.time.temporal.ChronoUnit.MINUTES);</span>
            
<span class="nc" id="L446">            Appointment apt1 = createAppointment(&quot;APT001&quot;, AppointmentType.CONSULTATION, &quot;Initial Consultation&quot;,</span>
<span class="nc" id="L447">                    now.plusHours(1), Duration.ofMinutes(60), com.vikk.appointmentscheduler.model.Priority.HIGH);</span>
<span class="nc" id="L448">            Appointment apt2 = createAppointment(&quot;APT002&quot;, AppointmentType.FOLLOW_UP, &quot;Follow-up Visit&quot;,</span>
<span class="nc" id="L449">                    now.plusHours(2), Duration.ofMinutes(30), com.vikk.appointmentscheduler.model.Priority.MEDIUM);</span>
<span class="nc" id="L450">            Appointment apt3 = createAppointment(&quot;APT003&quot;, AppointmentType.TREATMENT, &quot;Physical Therapy&quot;,</span>
<span class="nc" id="L451">                    now.plusHours(1).plusMinutes(30), Duration.ofMinutes(60), com.vikk.appointmentscheduler.model.Priority.MEDIUM);</span>
<span class="nc" id="L452">            Appointment apt4 = createAppointment(&quot;APT004&quot;, AppointmentType.EMERGENCY, &quot;Emergency Consultation&quot;,</span>
<span class="nc" id="L453">                    now.plusMinutes(10), Duration.ofMinutes(30), com.vikk.appointmentscheduler.model.Priority.URGENT);</span>
<span class="nc" id="L454">            Appointment apt5 = createAppointment(&quot;APT005&quot;, AppointmentType.SURGERY, &quot;Minor Surgery&quot;,</span>
<span class="nc" id="L455">                    now.plusHours(3), Duration.ofMinutes(60), com.vikk.appointmentscheduler.model.Priority.HIGH);</span>
<span class="nc" id="L456">            Appointment apt6 = createAppointment(&quot;APT006&quot;, AppointmentType.CONSULTATION, &quot;Routine Checkup&quot;,</span>
<span class="nc" id="L457">                    now.plusHours(2).plusMinutes(45), Duration.ofMinutes(30), com.vikk.appointmentscheduler.model.Priority.LOW);</span>

            // Save appointments to database
<span class="nc" id="L460">            appointmentDAO.save(apt1);</span>
<span class="nc" id="L461">            appointmentDAO.save(apt2);</span>
<span class="nc" id="L462">            appointmentDAO.save(apt3);</span>
<span class="nc" id="L463">            appointmentDAO.save(apt4);</span>
<span class="nc" id="L464">            appointmentDAO.save(apt5);</span>
<span class="nc" id="L465">            appointmentDAO.save(apt6);</span>

            // Create sample resources
<span class="nc" id="L468">            Resource room1 = createResource(&quot;ROOM001&quot;, &quot;Examination Room 1&quot;, ResourceType.ROOM, </span>
<span class="nc" id="L469">                    Set.of(&quot;CONSULTATION&quot;, &quot;FOLLOW_UP&quot;), 50.0, now, now.plusDays(1));</span>
<span class="nc" id="L470">            Resource room2 = createResource(&quot;ROOM002&quot;, &quot;Treatment Room&quot;, ResourceType.ROOM, </span>
<span class="nc" id="L471">                    Set.of(&quot;TREATMENT&quot;, &quot;THERAPY&quot;), 75.0, now, now.plusDays(1));</span>
<span class="nc" id="L472">            Resource room3 = createResource(&quot;ROOM003&quot;, &quot;Emergency Room&quot;, ResourceType.ROOM, </span>
<span class="nc" id="L473">                    Set.of(&quot;EMERGENCY&quot;), 100.0, now, now.plusDays(1));</span>
<span class="nc" id="L474">            Resource room4 = createResource(&quot;ROOM004&quot;, &quot;Operating Room&quot;, ResourceType.ROOM, </span>
<span class="nc" id="L475">                    Set.of(&quot;SURGERY&quot;), 200.0, now, now.plusDays(1));</span>
<span class="nc" id="L476">            Resource staff1 = createResource(&quot;STAFF001&quot;, &quot;Dr. Smith&quot;, ResourceType.STAFF, </span>
<span class="nc" id="L477">                    Set.of(&quot;CONSULTATION&quot;, &quot;FOLLOW_UP&quot;), 150.0, now, now.plusDays(1));</span>
<span class="nc" id="L478">            Resource staff2 = createResource(&quot;STAFF002&quot;, &quot;Physical Therapist&quot;, ResourceType.STAFF, </span>
<span class="nc" id="L479">                    Set.of(&quot;TREATMENT&quot;, &quot;THERAPY&quot;), 80.0, now, now.plusDays(1));</span>
<span class="nc" id="L480">            Resource staff3 = createResource(&quot;STAFF003&quot;, &quot;Dr. Johnson (Surgeon)&quot;, ResourceType.STAFF, </span>
<span class="nc" id="L481">                    Set.of(&quot;SURGERY&quot;), 300.0, now, now.plusDays(1));</span>

            // Save resources to database
<span class="nc" id="L484">            resourceDAO.save(room1);</span>
<span class="nc" id="L485">            resourceDAO.save(room2);</span>
<span class="nc" id="L486">            resourceDAO.save(room3);</span>
<span class="nc" id="L487">            resourceDAO.save(room4);</span>
<span class="nc" id="L488">            resourceDAO.save(staff1);</span>
<span class="nc" id="L489">            resourceDAO.save(staff2);</span>
<span class="nc" id="L490">            resourceDAO.save(staff3);</span>

            // Reload data from database
<span class="nc" id="L493">            loadDataFromDatabase();</span>
            
<span class="nc" id="L495">            logArea.appendText(&quot;Created sample data\n&quot;);</span>
            
<span class="nc" id="L497">        } catch (Exception e) {</span>
<span class="nc" id="L498">            logArea.appendText(&quot;Error creating sample data: &quot; + e.getMessage() + &quot;\n&quot;);</span>
<span class="nc" id="L499">        }</span>
<span class="nc" id="L500">    }</span>

    private Resource createResource(String id, String name, ResourceType type, Set&lt;String&gt; capabilities, 
                                  double costPerHour, LocalDateTime availableFrom, LocalDateTime availableTo) {
<span class="nc" id="L504">        Resource resource = new Resource();</span>
<span class="nc" id="L505">        resource.setId(id);</span>
<span class="nc" id="L506">        resource.setName(name);</span>
<span class="nc" id="L507">        resource.setType(type);</span>
<span class="nc" id="L508">        resource.setCapabilities(capabilities);</span>
<span class="nc" id="L509">        resource.setCostPerHour(costPerHour);</span>
<span class="nc" id="L510">        resource.setAvailableFrom(availableFrom);</span>
<span class="nc" id="L511">        resource.setAvailableTo(availableTo);</span>
<span class="nc" id="L512">        resource.setActive(true);</span>
<span class="nc" id="L513">        return resource;</span>
    }

    private void runOptimization() {
<span class="nc bnc" id="L517" title="All 4 branches missed.">        if (appointments.isEmpty() || resources.isEmpty()) {</span>
<span class="nc" id="L518">            showAlert(&quot;Error&quot;, &quot;Please add at least one appointment and one resource before running optimization.&quot;);</span>
<span class="nc" id="L519">            return;</span>
        }

        // Update service with current data
<span class="nc" id="L523">        schedulingService = new AppointmentSchedulingService(</span>
<span class="nc" id="L524">            appointments.stream().collect(Collectors.toList()),</span>
<span class="nc" id="L525">            resources.stream().collect(Collectors.toList())</span>
        );

        // The service already has all algorithms registered
        // We'll filter results based on selection

<span class="nc bnc" id="L531" title="All 2 branches missed.">        if (schedulingService.getRegisteredAlgorithms().isEmpty()) {</span>
<span class="nc" id="L532">            showAlert(&quot;Error&quot;, &quot;Please select at least one algorithm.&quot;);</span>
<span class="nc" id="L533">            return;</span>
        }

        // Run optimization asynchronously
<span class="nc" id="L537">        progressBar.setVisible(true);</span>
<span class="nc" id="L538">        progressBar.setProgress(-1); // Indeterminate progress</span>
<span class="nc" id="L539">        statusLabel.setText(&quot;Running optimization...&quot;);</span>
<span class="nc" id="L540">        logArea.appendText(&quot;Starting optimization with &quot; + schedulingService.getRegisteredAlgorithms().size() + &quot; algorithms...\n&quot;);</span>

<span class="nc" id="L542">        CompletableFuture.runAsync(() -&gt; {</span>
            try {
<span class="nc" id="L544">                Map&lt;String, Schedule&gt; results = new HashMap&lt;&gt;();</span>
                
                // Run selected algorithms
<span class="nc bnc" id="L547" title="All 2 branches missed.">                if (cspCheckBox.isSelected()) {</span>
<span class="nc" id="L548">                    Schedule cspResult = schedulingService.optimizeSchedule(&quot;CSP&quot;);</span>
<span class="nc" id="L549">                    results.put(&quot;CSP&quot;, cspResult);</span>
                }
<span class="nc bnc" id="L551" title="All 2 branches missed.">                if (gaCheckBox.isSelected()) {</span>
<span class="nc" id="L552">                    Schedule gaResult = schedulingService.optimizeSchedule(&quot;GA&quot;);</span>
<span class="nc" id="L553">                    results.put(&quot;GA&quot;, gaResult);</span>
                }
<span class="nc bnc" id="L555" title="All 2 branches missed.">                if (saCheckBox.isSelected()) {</span>
<span class="nc" id="L556">                    Schedule saResult = schedulingService.optimizeSchedule(&quot;SA&quot;);</span>
<span class="nc" id="L557">                    results.put(&quot;SA&quot;, saResult);</span>
                }
                
                // Store results for display
<span class="nc" id="L561">                optimizationResults.clear();</span>
<span class="nc" id="L562">                optimizationResults.putAll(results);</span>
                
<span class="nc" id="L564">                final Map&lt;String, AppointmentSchedulingService.AlgorithmComparisonResult&gt; comparisonResults = schedulingService.compareAlgorithms();</span>

<span class="nc" id="L566">                Platform.runLater(() -&gt; {</span>
<span class="nc" id="L567">                    updateResultsTable(comparisonResults);</span>
<span class="nc" id="L568">                    updateBestScheduleDisplay();</span>
<span class="nc" id="L569">                    progressBar.setVisible(false);</span>
<span class="nc" id="L570">                    statusLabel.setText(&quot;Optimization completed&quot;);</span>
<span class="nc" id="L571">                    logArea.appendText(&quot;Optimization completed successfully!\n&quot;);</span>
<span class="nc" id="L572">                });</span>
<span class="nc" id="L573">            } catch (Exception e) {</span>
<span class="nc" id="L574">                Platform.runLater(() -&gt; {</span>
<span class="nc" id="L575">                    progressBar.setVisible(false);</span>
<span class="nc" id="L576">                    statusLabel.setText(&quot;Optimization failed&quot;);</span>
<span class="nc" id="L577">                    logArea.appendText(&quot;Error: &quot; + e.getMessage() + &quot;\n&quot;);</span>
<span class="nc" id="L578">                    showAlert(&quot;Error&quot;, &quot;Optimization failed: &quot; + e.getMessage());</span>
<span class="nc" id="L579">                });</span>
<span class="nc" id="L580">            }</span>
<span class="nc" id="L581">        });</span>
<span class="nc" id="L582">    }</span>

    private void updateResultsTable(Map&lt;String, AppointmentSchedulingService.AlgorithmComparisonResult&gt; results) {
<span class="nc" id="L585">        ObservableList&lt;ScheduleResult&gt; resultData = FXCollections.observableArrayList();</span>
        
<span class="nc bnc" id="L587" title="All 2 branches missed.">        for (AppointmentSchedulingService.AlgorithmComparisonResult result : results.values()) {</span>
<span class="nc" id="L588">            resultData.add(new ScheduleResult(</span>
<span class="nc" id="L589">                result.getAlgorithmName(),</span>
<span class="nc" id="L590">                result.getExecutionTime(),</span>
<span class="nc" id="L591">                result.getIterations(),</span>
<span class="nc" id="L592">                result.getEfficiencyScore(),</span>
<span class="nc" id="L593">                result.getTotalCost(),</span>
<span class="nc" id="L594">                result.getConflictCount()</span>
            ));
<span class="nc" id="L596">        }</span>
        
<span class="nc" id="L598">        resultTable.setItems(resultData);</span>
<span class="nc" id="L599">    }</span>

    private void updateBestScheduleDisplay() {
<span class="nc bnc" id="L602" title="All 2 branches missed.">        if (optimizationResults.isEmpty()) {</span>
<span class="nc" id="L603">            scheduleArea.setText(&quot;No optimization results available. Run optimization first.&quot;);</span>
<span class="nc" id="L604">            return;</span>
        }
        
        // Find the best schedule (lowest cost, highest efficiency)
<span class="nc" id="L608">        Schedule bestSchedule = null;</span>
<span class="nc" id="L609">        String bestAlgorithm = &quot;&quot;;</span>
<span class="nc" id="L610">        double bestScore = Double.MAX_VALUE;</span>
        
<span class="nc bnc" id="L612" title="All 2 branches missed.">        for (Map.Entry&lt;String, Schedule&gt; entry : optimizationResults.entrySet()) {</span>
<span class="nc" id="L613">            String algorithm = entry.getKey();</span>
<span class="nc" id="L614">            Schedule schedule = entry.getValue();</span>
            
            // Calculate a simple score (lower is better)
<span class="nc" id="L617">            double efficiencyScore = schedule.calculateEfficiencyScore();</span>
<span class="nc" id="L618">            double score = schedule.getTotalCost() - (efficiencyScore * 10);</span>
<span class="nc bnc" id="L619" title="All 2 branches missed.">            if (score &lt; bestScore) {</span>
<span class="nc" id="L620">                bestScore = score;</span>
<span class="nc" id="L621">                bestSchedule = schedule;</span>
<span class="nc" id="L622">                bestAlgorithm = algorithm;</span>
            }
<span class="nc" id="L624">        }</span>
        
<span class="nc bnc" id="L626" title="All 2 branches missed.">        if (bestSchedule != null) {</span>
<span class="nc" id="L627">            displayScheduleDetails(bestSchedule, bestAlgorithm);</span>
        }
<span class="nc" id="L629">    }</span>
    
    private void displayScheduleDetails(Schedule schedule, String algorithm) {
<span class="nc" id="L632">        StringBuilder sb = new StringBuilder();</span>
<span class="nc" id="L633">        sb.append(&quot;BEST SCHEDULE - &quot;).append(algorithm).append(&quot; Algorithm\n&quot;);</span>
<span class="nc" id="L634">        sb.append(&quot;==========================================\n\n&quot;);</span>
        
<span class="nc" id="L636">        sb.append(&quot;Schedule ID: &quot;).append(schedule.getId()).append(&quot;\n&quot;);</span>
<span class="nc bnc" id="L637" title="All 2 branches missed.">        sb.append(&quot;Start Date: &quot;).append(schedule.getStartDate() != null ? schedule.getStartDate().format(TIME_FORMATTER) : &quot;Not set&quot;).append(&quot;\n&quot;);</span>
<span class="nc bnc" id="L638" title="All 2 branches missed.">        sb.append(&quot;End Date: &quot;).append(schedule.getEndDate() != null ? schedule.getEndDate().format(TIME_FORMATTER) : &quot;Not set&quot;).append(&quot;\n&quot;);</span>
<span class="nc" id="L639">        sb.append(&quot;Total Cost: $&quot;).append(String.format(&quot;%.2f&quot;, schedule.getTotalCost())).append(&quot;\n&quot;);</span>
<span class="nc" id="L640">        sb.append(&quot;Efficiency Score: &quot;).append(String.format(&quot;%.2f&quot;, schedule.calculateEfficiencyScore())).append(&quot;%\n&quot;);</span>
<span class="nc" id="L641">        sb.append(&quot;Conflict Count: &quot;).append(schedule.getConflictCount()).append(&quot;\n\n&quot;);</span>
        
<span class="nc" id="L643">        sb.append(&quot;SCHEDULED APPOINTMENTS:\n&quot;);</span>
<span class="nc" id="L644">        sb.append(&quot;======================\n&quot;);</span>
        
<span class="nc bnc" id="L646" title="All 2 branches missed.">        if (schedule.getAppointments().isEmpty()) {</span>
<span class="nc" id="L647">            sb.append(&quot;No appointments scheduled.\n&quot;);</span>
        } else {
<span class="nc bnc" id="L649" title="All 2 branches missed.">            for (Appointment appointment : schedule.getAppointments()) {</span>
<span class="nc" id="L650">                sb.append(&quot;• &quot;).append(appointment.getId()).append(&quot; - &quot;).append(appointment.getTitle()).append(&quot;\n&quot;);</span>
<span class="nc" id="L651">                sb.append(&quot;  Time: &quot;).append(appointment.getStartTime().format(TIME_FORMATTER));</span>
<span class="nc bnc" id="L652" title="All 2 branches missed.">                if (appointment.getEndTime() != null) {</span>
<span class="nc" id="L653">                    sb.append(&quot; - &quot;).append(appointment.getEndTime().format(TIME_FORMATTER));</span>
                }
<span class="nc" id="L655">                sb.append(&quot;\n&quot;);</span>
<span class="nc" id="L656">                String resourceId = schedule.getResourceForAppointment(appointment.getId());</span>
<span class="nc bnc" id="L657" title="All 2 branches missed.">                sb.append(&quot;  Resource: &quot;).append(resourceId != null ? resourceId : &quot;Not assigned&quot;).append(&quot;\n&quot;);</span>
<span class="nc" id="L658">                sb.append(&quot;  Type: &quot;).append(appointment.getType()).append(&quot; | Priority: &quot;).append(appointment.getPriority()).append(&quot;\n\n&quot;);</span>
<span class="nc" id="L659">            }</span>
        }
        
<span class="nc" id="L662">        sb.append(&quot;UNSCHEDULED APPOINTMENTS:\n&quot;);</span>
<span class="nc" id="L663">        sb.append(&quot;========================\n&quot;);</span>
        
<span class="nc bnc" id="L665" title="All 2 branches missed.">        if (schedule.getUnassignedAppointments().isEmpty()) {</span>
<span class="nc" id="L666">            sb.append(&quot;All appointments scheduled successfully!\n&quot;);</span>
        } else {
<span class="nc" id="L668">            sb.append(&quot;Unassigned appointment IDs: &quot;).append(String.join(&quot;, &quot;, schedule.getUnassignedAppointments())).append(&quot;\n&quot;);</span>
        }
        
<span class="nc" id="L671">        scheduleArea.setText(sb.toString());</span>
<span class="nc" id="L672">    }</span>

    private void updateScheduleDisplay(TextArea scheduleArea, ScheduleResult result) {
        // This would display the actual schedule details
        // For now, show a summary
<span class="nc" id="L677">        StringBuilder sb = new StringBuilder();</span>
<span class="nc" id="L678">        sb.append(&quot;Schedule for &quot;).append(result.getAlgorithmName()).append(&quot;\n&quot;);</span>
<span class="nc" id="L679">        sb.append(&quot;=====================================\n&quot;);</span>
<span class="nc" id="L680">        sb.append(&quot;Execution Time: &quot;).append(result.getExecutionTime()).append(&quot; ms\n&quot;);</span>
<span class="nc" id="L681">        sb.append(&quot;Efficiency: &quot;).append(String.format(&quot;%.2f&quot;, result.getEfficiencyScore())).append(&quot;%\n&quot;);</span>
<span class="nc" id="L682">        sb.append(&quot;Total Cost: $&quot;).append(String.format(&quot;%.2f&quot;, result.getTotalCost())).append(&quot;\n&quot;);</span>
<span class="nc" id="L683">        sb.append(&quot;Conflicts: &quot;).append(result.getConflictCount()).append(&quot;\n&quot;);</span>
        
<span class="nc" id="L685">        scheduleArea.setText(sb.toString());</span>
<span class="nc" id="L686">    }</span>

    private void showAddAppointmentDialog() {
        try {
<span class="nc" id="L690">            AppointmentDialog dialog = new AppointmentDialog((Stage) appointmentTable.getScene().getWindow(), null);</span>
<span class="nc" id="L691">            Appointment newAppointment = dialog.showAndWait();</span>
            
<span class="nc bnc" id="L693" title="All 2 branches missed.">            if (newAppointment != null) {</span>
<span class="nc" id="L694">                appointmentDAO.save(newAppointment);</span>
<span class="nc" id="L695">                loadDataFromDatabase();</span>
<span class="nc" id="L696">                logArea.appendText(&quot;Added appointment: &quot; + newAppointment.getId() + &quot;\n&quot;);</span>
            }
<span class="nc" id="L698">        } catch (Exception e) {</span>
<span class="nc" id="L699">            logArea.appendText(&quot;Error adding appointment: &quot; + e.getMessage() + &quot;\n&quot;);</span>
<span class="nc" id="L700">            showAlert(&quot;Error&quot;, &quot;Failed to add appointment: &quot; + e.getMessage());</span>
<span class="nc" id="L701">        }</span>
<span class="nc" id="L702">    }</span>

    private void showAddResourceDialog() {
        try {
<span class="nc" id="L706">            ResourceDialog dialog = new ResourceDialog((Stage) resourceTable.getScene().getWindow(), null);</span>
<span class="nc" id="L707">            Resource newResource = dialog.showAndWait();</span>
            
<span class="nc bnc" id="L709" title="All 2 branches missed.">            if (newResource != null) {</span>
<span class="nc" id="L710">                resourceDAO.save(newResource);</span>
<span class="nc" id="L711">                loadDataFromDatabase();</span>
<span class="nc" id="L712">                logArea.appendText(&quot;Added resource: &quot; + newResource.getId() + &quot;\n&quot;);</span>
            }
<span class="nc" id="L714">        } catch (Exception e) {</span>
<span class="nc" id="L715">            logArea.appendText(&quot;Error adding resource: &quot; + e.getMessage() + &quot;\n&quot;);</span>
<span class="nc" id="L716">            showAlert(&quot;Error&quot;, &quot;Failed to add resource: &quot; + e.getMessage());</span>
<span class="nc" id="L717">        }</span>
<span class="nc" id="L718">    }</span>

    private void editSelectedAppointment() {
<span class="nc" id="L721">        Appointment selected = appointmentTable.getSelectionModel().getSelectedItem();</span>
<span class="nc bnc" id="L722" title="All 2 branches missed.">        if (selected != null) {</span>
            try {
<span class="nc" id="L724">                AppointmentDialog dialog = new AppointmentDialog((Stage) appointmentTable.getScene().getWindow(), selected);</span>
<span class="nc" id="L725">                Appointment updatedAppointment = dialog.showAndWait();</span>
                
<span class="nc bnc" id="L727" title="All 2 branches missed.">                if (updatedAppointment != null) {</span>
<span class="nc" id="L728">                    appointmentDAO.update(updatedAppointment);</span>
<span class="nc" id="L729">                    loadDataFromDatabase();</span>
<span class="nc" id="L730">                    logArea.appendText(&quot;Updated appointment: &quot; + updatedAppointment.getId() + &quot;\n&quot;);</span>
                }
<span class="nc" id="L732">            } catch (Exception e) {</span>
<span class="nc" id="L733">                logArea.appendText(&quot;Error updating appointment: &quot; + e.getMessage() + &quot;\n&quot;);</span>
<span class="nc" id="L734">                showAlert(&quot;Error&quot;, &quot;Failed to update appointment: &quot; + e.getMessage());</span>
<span class="nc" id="L735">            }</span>
        } else {
<span class="nc" id="L737">            showAlert(&quot;Selection Required&quot;, &quot;Please select an appointment to edit.&quot;);</span>
        }
<span class="nc" id="L739">    }</span>

    private void deleteSelectedAppointment() {
<span class="nc" id="L742">        Appointment selected = appointmentTable.getSelectionModel().getSelectedItem();</span>
<span class="nc bnc" id="L743" title="All 2 branches missed.">        if (selected != null) {</span>
            try {
<span class="nc" id="L745">                Alert confirmAlert = new Alert(Alert.AlertType.CONFIRMATION);</span>
<span class="nc" id="L746">                confirmAlert.setTitle(&quot;Confirm Delete&quot;);</span>
<span class="nc" id="L747">                confirmAlert.setHeaderText(&quot;Delete Appointment&quot;);</span>
<span class="nc" id="L748">                confirmAlert.setContentText(&quot;Are you sure you want to delete appointment: &quot; + selected.getId() + &quot;?&quot;);</span>
                
<span class="nc bnc" id="L750" title="All 2 branches missed.">                if (confirmAlert.showAndWait().orElse(ButtonType.CANCEL) == ButtonType.OK) {</span>
<span class="nc" id="L751">                    appointmentDAO.delete(selected.getId());</span>
<span class="nc" id="L752">                    loadDataFromDatabase();</span>
<span class="nc" id="L753">                    logArea.appendText(&quot;Deleted appointment: &quot; + selected.getId() + &quot;\n&quot;);</span>
                }
<span class="nc" id="L755">            } catch (Exception e) {</span>
<span class="nc" id="L756">                logArea.appendText(&quot;Error deleting appointment: &quot; + e.getMessage() + &quot;\n&quot;);</span>
<span class="nc" id="L757">                showAlert(&quot;Error&quot;, &quot;Failed to delete appointment: &quot; + e.getMessage());</span>
<span class="nc" id="L758">            }</span>
        } else {
<span class="nc" id="L760">            showAlert(&quot;Selection Required&quot;, &quot;Please select an appointment to delete.&quot;);</span>
        }
<span class="nc" id="L762">    }</span>

    private void editSelectedResource() {
<span class="nc" id="L765">        Resource selected = resourceTable.getSelectionModel().getSelectedItem();</span>
<span class="nc bnc" id="L766" title="All 2 branches missed.">        if (selected != null) {</span>
            try {
<span class="nc" id="L768">                ResourceDialog dialog = new ResourceDialog((Stage) resourceTable.getScene().getWindow(), selected);</span>
<span class="nc" id="L769">                Resource updatedResource = dialog.showAndWait();</span>
                
<span class="nc bnc" id="L771" title="All 2 branches missed.">                if (updatedResource != null) {</span>
<span class="nc" id="L772">                    resourceDAO.update(updatedResource);</span>
<span class="nc" id="L773">                    loadDataFromDatabase();</span>
<span class="nc" id="L774">                    logArea.appendText(&quot;Updated resource: &quot; + updatedResource.getId() + &quot;\n&quot;);</span>
                }
<span class="nc" id="L776">            } catch (Exception e) {</span>
<span class="nc" id="L777">                logArea.appendText(&quot;Error updating resource: &quot; + e.getMessage() + &quot;\n&quot;);</span>
<span class="nc" id="L778">                showAlert(&quot;Error&quot;, &quot;Failed to update resource: &quot; + e.getMessage());</span>
<span class="nc" id="L779">            }</span>
        } else {
<span class="nc" id="L781">            showAlert(&quot;Selection Required&quot;, &quot;Please select a resource to edit.&quot;);</span>
        }
<span class="nc" id="L783">    }</span>

    private void deleteSelectedResource() {
<span class="nc" id="L786">        Resource selected = resourceTable.getSelectionModel().getSelectedItem();</span>
<span class="nc bnc" id="L787" title="All 2 branches missed.">        if (selected != null) {</span>
            try {
<span class="nc" id="L789">                Alert confirmAlert = new Alert(Alert.AlertType.CONFIRMATION);</span>
<span class="nc" id="L790">                confirmAlert.setTitle(&quot;Confirm Delete&quot;);</span>
<span class="nc" id="L791">                confirmAlert.setHeaderText(&quot;Delete Resource&quot;);</span>
<span class="nc" id="L792">                confirmAlert.setContentText(&quot;Are you sure you want to delete resource: &quot; + selected.getId() + &quot;?&quot;);</span>
                
<span class="nc bnc" id="L794" title="All 2 branches missed.">                if (confirmAlert.showAndWait().orElse(ButtonType.CANCEL) == ButtonType.OK) {</span>
<span class="nc" id="L795">                    resourceDAO.delete(selected.getId());</span>
<span class="nc" id="L796">                    loadDataFromDatabase();</span>
<span class="nc" id="L797">                    logArea.appendText(&quot;Deleted resource: &quot; + selected.getId() + &quot;\n&quot;);</span>
                }
<span class="nc" id="L799">            } catch (Exception e) {</span>
<span class="nc" id="L800">                logArea.appendText(&quot;Error deleting resource: &quot; + e.getMessage() + &quot;\n&quot;);</span>
<span class="nc" id="L801">                showAlert(&quot;Error&quot;, &quot;Failed to delete resource: &quot; + e.getMessage());</span>
<span class="nc" id="L802">            }</span>
        } else {
<span class="nc" id="L804">            showAlert(&quot;Selection Required&quot;, &quot;Please select a resource to delete.&quot;);</span>
        }
<span class="nc" id="L806">    }</span>

    private void clearAllData() {
        try {
<span class="nc" id="L810">            Alert confirmAlert = new Alert(Alert.AlertType.CONFIRMATION);</span>
<span class="nc" id="L811">            confirmAlert.setTitle(&quot;Confirm Clear All Data&quot;);</span>
<span class="nc" id="L812">            confirmAlert.setHeaderText(&quot;Clear All Data&quot;);</span>
<span class="nc" id="L813">            confirmAlert.setContentText(&quot;Are you sure you want to delete ALL appointments and resources? This action cannot be undone.&quot;);</span>
            
<span class="nc bnc" id="L815" title="All 2 branches missed.">            if (confirmAlert.showAndWait().orElse(ButtonType.CANCEL) == ButtonType.OK) {</span>
                // Clear database
<span class="nc" id="L817">                appointmentDAO.deleteAll();</span>
<span class="nc" id="L818">                resourceDAO.deleteAll();</span>
                
                // Clear UI
<span class="nc" id="L821">                appointments.clear();</span>
<span class="nc" id="L822">                resources.clear();</span>
<span class="nc" id="L823">                resultTable.getItems().clear();</span>
<span class="nc" id="L824">                logArea.clear();</span>
<span class="nc" id="L825">                statusLabel.setText(&quot;All data cleared&quot;);</span>
                
<span class="nc" id="L827">                logArea.appendText(&quot;All data cleared from database\n&quot;);</span>
            }
<span class="nc" id="L829">        } catch (Exception e) {</span>
<span class="nc" id="L830">            logArea.appendText(&quot;Error clearing data: &quot; + e.getMessage() + &quot;\n&quot;);</span>
<span class="nc" id="L831">            showAlert(&quot;Error&quot;, &quot;Failed to clear data: &quot; + e.getMessage());</span>
<span class="nc" id="L832">        }</span>
<span class="nc" id="L833">    }</span>

    private void showAlert(String title, String message) {
<span class="nc" id="L836">        Alert alert = new Alert(Alert.AlertType.INFORMATION);</span>
<span class="nc" id="L837">        alert.setTitle(title);</span>
<span class="nc" id="L838">        alert.setHeaderText(null);</span>
<span class="nc" id="L839">        alert.setContentText(message);</span>
<span class="nc" id="L840">        alert.showAndWait();</span>
<span class="nc" id="L841">    }</span>

    private Appointment createAppointment(String id, AppointmentType type, String description, 
                                        LocalDateTime startTime, Duration duration, com.vikk.appointmentscheduler.model.Priority priority) {
<span class="nc" id="L845">        Appointment appointment = new Appointment(id, description, startTime, duration);</span>
<span class="nc" id="L846">        appointment.setType(type);</span>
<span class="nc" id="L847">        appointment.setPriority(priority);</span>
<span class="nc" id="L848">        appointment.setStatus(AppointmentStatus.PENDING);</span>
<span class="nc" id="L849">        return appointment;</span>
    }

    public static void main(String[] args) {
<span class="nc" id="L853">        launch(args);</span>
<span class="nc" id="L854">    }</span>

    // Helper class for result table
    public static class ScheduleResult {
        private final String algorithmName;
        private final long executionTime;
        private final int iterations;
        private final double efficiencyScore;
        private final double totalCost;
        private final int conflictCount;

        public ScheduleResult(String algorithmName, long executionTime, int iterations, 
<span class="nc" id="L866">                            double efficiencyScore, double totalCost, int conflictCount) {</span>
<span class="nc" id="L867">            this.algorithmName = algorithmName;</span>
<span class="nc" id="L868">            this.executionTime = executionTime;</span>
<span class="nc" id="L869">            this.iterations = iterations;</span>
<span class="nc" id="L870">            this.efficiencyScore = efficiencyScore;</span>
<span class="nc" id="L871">            this.totalCost = totalCost;</span>
<span class="nc" id="L872">            this.conflictCount = conflictCount;</span>
<span class="nc" id="L873">        }</span>

        // Getters
<span class="nc" id="L876">        public String getAlgorithmName() { return algorithmName; }</span>
<span class="nc" id="L877">        public long getExecutionTime() { return executionTime; }</span>
<span class="nc" id="L878">        public int getIterations() { return iterations; }</span>
<span class="nc" id="L879">        public double getEfficiencyScore() { return efficiencyScore; }</span>
<span class="nc" id="L880">        public double getTotalCost() { return totalCost; }</span>
<span class="nc" id="L881">        public int getConflictCount() { return conflictCount; }</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.10.202304240956</span></div></body></html>